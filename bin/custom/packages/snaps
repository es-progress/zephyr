#!/usr/bin/env bash
###############
## ES-Ubuntu ##
##           ##
## Packages  ##
## snap      ##
###############

# Strict mode minus IFS
set -euo pipefail

# Check if not run as root
if [[ $(id -u) -eq 0 ]]; then
    echo "Don't run as root!"
    exit 1
fi

# Remove blank lines, comments from package list
snaps=$(sed -r -e '/^\s*$/ d' -e '/\s*#/ d' "${ESUBUNTU_HOME}/files/packages/snap")

# Parse snap list
while read -r package mode; do

    # Set options
    options=""
    [[ "${mode}" == "classic" ]] && options="--classic"

    # Install snap
    echo
    echo "Installing ${package}..."
    sudo snap install ${options} "${package}"
    echo -e "\e[32m\e[1mDone\e[0m"

done <<< "${snaps}"

exit 0
