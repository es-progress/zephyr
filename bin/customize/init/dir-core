#!/usr/bin/env bash
###############
## ES-Ubuntu ##
##           ##
## Config    ##
## Core dirs ##
###############

# Strict mode
set -euo pipefail
IFS=$'\n\t'

source "${PROJECT_ROOT}/bootstrap.sh"
check-not-root || exit 1

if [[ -f "${ES_CFG_LOCAL}/config/customize/init/dir-core" ]]; then
    print-status "Create core dirs..."
    core_dirs=$(read-file-cfg "${ES_CFG_LOCAL}/config/customize/init/dir-core")
    for line in ${core_dirs}; do
        IFS=$' \t' read -r path owner <<< "${line}"
        # eval line to let the shell expand tilde and env vars
        path=$(eval echo "${path}")
        owner=$(eval echo "${owner}")
        sudo mkdir -p "${path}"
        [[ -n "${owner}" ]] && sudo chown "${owner}:${owner}" "${path}"
    done
    print-finish
fi

exit 0
