#!/usr/bin/env bash
###############
## ES-Ubuntu ##
##           ##
## Config    ##
## GNOME     ##
## User dirs ##
###############

# Strict mode
set -euo pipefail
IFS=$'\n\t'

source "${DIR_ESUBUNTU}/bootstrap.sh"
check-not-root || exit 1

# Nautilus links
################
print-status "Copy global user dirs..."
sudo cp "${ES_CUSTOMIZE_CFG}/gnome/user-dirs.defaults" /etc/xdg/
print-finish
print-status "Copy user dirs..."
cp "${ES_CUSTOMIZE_CFG}/gnome/user-dirs.dirs" ~/.config/
print-finish

# Bookmarks
###########
print-status "Add global bookmarks..."
bookmarks=$(read-file-cfg "${ES_CUSTOMIZE_CFG}/gnome/bookmarks")
while read -r line; do
    # Check if it already contains
    if ! grep -qs -F -x "$line" ~/.config/gtk-3.0/bookmarks; then
        echo "$line" >> ~/.config/gtk-3.0/bookmarks
    fi
done <<< "${bookmarks}"
print-finish

if [[ -d "${ES_CFG_LOCAL}" ]]; then
    cd "${ES_CFG_LOCAL}"
    if [[ -f config/customize/gnome/bookmarks ]]; then
        print-status "Add local bookmarks..."
        bookmarks=$(read-file-cfg config/customize/gnome/bookmarks)
        while read -r line; do
            if ! grep -qs -F -x "$line" ~/.config/gtk-3.0/bookmarks; then
                echo "$line" >> ~/.config/gtk-3.0/bookmarks
            fi
        done <<< "${bookmarks}"
        print-finish
    fi
fi

exit 0
