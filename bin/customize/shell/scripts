#!/usr/bin/env bash
###############
## ES-Ubuntu ##
##           ##
## Config    ##
## Scripts   ##
###############

# Strict mode
set -euo pipefail
IFS=$'\n\t'

source "${DIR_ESUBUNTU}/bootstrap.sh"
check-not-root || exit 1

print-status "Copy global shell scripts..."
sudo mkdir -p "${GLOBAL_BIN}"
for file in "${ES_CUSTOMIZE_FILES}"/shell/bin/*; do
    file_name=$(basename "${file}")
    sudo cp "${file}" "${GLOBAL_BIN}"
    sudo chown root:root "${GLOBAL_BIN}/${file_name}"
    sudo chmod =0755 "${GLOBAL_BIN}/${file_name}"
done
print-finish

print-status "Copy global shell library..."
sudo mkdir -p "${GLOBAL_LIB}"
for file in "${ES_CUSTOMIZE_FILES}"/shell/lib/*; do
    file_name=$(basename "${file}")
    sudo cp "${file}" "${GLOBAL_LIB}"
    sudo chown root:root "${GLOBAL_LIB}/${file_name}"
    sudo chmod =0644 "${GLOBAL_LIB}/${file_name}"
done
print-finish

if [[ -d "${ES_CFG_LOCAL}/files/shell" ]]; then
    print-status "Copy local shell scripts..."
    mkdir -p "${LOCAL_BIN}"
    for file in "${ES_CFG_LOCAL}"/files/shell/*; do
        cp -a "${file}" "${LOCAL_BIN}"
    done
    print-finish
fi

print-status "Link esubuntuctl..."
[[ -e "${LOCAL_BIN}/esubuntuctl" ]] || ln -s "${DIR_ESUBUNTU}/esubuntuctl" "${LOCAL_BIN}/esubuntuctl"
print-finish

exit 0
